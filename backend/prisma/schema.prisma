generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("PRISMA_DATABASE_URL")
}

model User {
  id              Int          @id @default(autoincrement())
  googleId        String       @unique
  nickname        String
  profileImageUrl String?
  rating_mu       Float        @default(25.0)
  rating_sigma    Float        @default(8.333)
  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @updatedAt
  lastLoginAt     DateTime?
  // 게임 통계 (간단한 win/draw/lose 시스템)
  totalGames      Int           @default(0)
  result_wins     Int           @default(0)
  result_draws    Int           @default(0)
  result_losses   Int           @default(0)
  participatedGameIds Int[]     @default([]) // 참여한 게임 ID 목록
  allowGameHistoryView Boolean  @default(true) // 전적 공개 허용 여부
}

model Game {
  id          Int          @id @default(autoincrement())
  gameId      String       @unique
  playedAt    DateTime     @default(now())
  startedAt   DateTime?    // 게임 실제 시작 시간
  endedAt     DateTime?    // 게임 종료 시간
  duration    Int?         // 게임 소요 시간 (초)
  playerCount Int
  totalRounds Int
  roomType    String?
  roomTitle   String?
  
  // Player 1 정보
  player1_userId          Int
  player1_nickname        String
  player1_rank            Int
  player1_score           Int
  player1_rating_mu_change Float
  
  // Player 2 정보
  player2_userId          Int
  player2_nickname        String
  player2_rank            Int
  player2_score           Int
  player2_rating_mu_change Float
  
  // Player 3 정보 (옵션)
  player3_userId          Int?
  player3_nickname        String?
  player3_rank            Int?
  player3_score           Int?
  player3_rating_mu_change Float?
  
  // Player 4 정보 (옵션)
  player4_userId          Int?
  player4_nickname        String?
  player4_rank            Int?
  player4_score           Int?
  player4_rating_mu_change Float?
  
  // Player 5 정보 (옵션)
  player5_userId          Int?
  player5_nickname        String?
  player5_rank            Int?
  player5_score           Int?
  player5_rating_mu_change Float?

  @@index([gameId])
  @@index([playedAt])
  @@index([player1_userId])
  @@index([player2_userId])
}
